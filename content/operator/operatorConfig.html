<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  </head>   
<body>
<article class="doc">
<h1>Couchbase Operator Configuration</h1>
<div class="paragraph">
<p>The Couchbase Operator configuration is defined below. When loaded into
Kubernetes, it downloads the Couchbase Operator Docker image, creates
the CouchbaseCluster Custom Resource Definition(CRD), and starts
listening for CouchbaseCluster events. The Operator is defined as a
deployment to allow it to be restarted in the event of a pod or node
failure.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  name: couchbase-operator
  namespace: default
spec:
  replicas: 1
  template:
    metadata:
      labels:
        name: couchbase-operator
    spec:
      containers:
      - name: couchbase-operator
        image: couchbase/couchbase-operator:v1
        env:
        - name: MY_POD_NAMESPACE
          valueFrom:
            fieldRef:
              fieldPath: metadata.namespace
        - name: MY_POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        ports:
          - name: readiness-port
            containerPort: 8080
        readinessProbe:
          httpGet:
            path: /readyz
            port: readiness-port
          initialDelaySeconds: 3
          periodSeconds: 3
          failureThreshold: 19</code></pre>
</div>
</div>
<div class="paragraph">
<p>Most fields in the Operator configuration should never be changed and we
recommend using the configuration as is. Some exceptions are below.</p>
</div>
<div class="paragraph">
<p><strong>Changing The Namespace</strong></p>
</div>
<div class="paragraph">
<p>The Operator manages clusters in the namespace that it is deployed in.
If you want to deploy the Operator in a namespace other than the default
namespace, then change the <code>metadata.namespace</code> field.</p>
</div>
<div class="paragraph">
<p><strong>Changing The Operation Container Image</strong></p>
</div>
<div class="paragraph">
<p>You should not need to change the Operator image unless you are pulling
the image from somewhere other than the official Couchbase Docker
repository. If you are pulling the image from somewhere else, change the
<code>spec.spec.containers[0].image</code> field.</p>
</div>
<div class="paragraph">
<p><strong>Changing the Name</strong></p>
</div>
<div class="paragraph">
<p>By default the name of the deployment created to maintain the Couchbase
Operator is called couchbase-operator. We recommend keeping this name
since it is used in all of our examples and tutorials. If you need to
change it for some reason, ensure that you change the <code>metadata.name</code>,
<code>spec.template.metadata.labels.name</code>, and <code>spec.spec.containers[0].name</code>
fields. These fields also must all have the same value.</p>
</div>
  </article>
</body>
</html>
